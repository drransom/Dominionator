var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,b)}else for(c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.superClass_=b.prototype};
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).i}},"es6","es3");var Cost$$module$lib$cost=function(a){this.coinCost="N"===a.cost?null:a.cost;this.potion=a.potionCost?"P":"";this.debtCost="N"===a.debtCost?null:a.debtCost};Cost$$module$lib$cost.prototype.compareCost=function(a){var b=Math.max([this.coinCost,this.getDebtCost()]),c=Math.max([a.coinCost,a.getDebtCost()]);return b>c?1:b==c?this.compareByPotion(a):-1};
Cost$$module$lib$cost.prototype.compareByPotion=function(a){return this.potion===a.potion?0:this.potion?1:-1};Cost$$module$lib$cost.prototype.costString=function(){var a=this.debtCost?""+this.debtString+"D":"";return this.isNull()?"":this.coinCost||this.debtCost||!this.potion?""+this.coinCost+a+this.potion:this.potion};Cost$$module$lib$cost.prototype.getDebtCost=function(){return null===this.debtCost?0:this.debtCost};
Cost$$module$lib$cost.prototype.getCoinCost=function(){return null===this.coinCost?0:this.coinCost};Cost$$module$lib$cost.prototype.isZero=function(){return!this.isNull()&&!this.getCoinCost()&&!this.getDebtCost()&&!this.potion};Cost$$module$lib$cost.prototype.isNull=function(){return null===this.coinCost&&null===this.debtCost&&""===this.potion};var module$lib$cost={};module$lib$cost.Cost=Cost$$module$lib$cost;var Helpers$$module$lib$helpers=function(){};Helpers$$module$lib$helpers.titleCase=function(a){var b=/^(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|vs?\.?|via)$/i;return a.replace(/([^\W_]+[^\s-]*) */g,function(a,d,e,f){return 0<e&&e+d.length!==f.length&&-1<d.search(b)&&":"!==f.charAt(e-2)&&0>f.charAt(e-1).search(/[^\s-]/)?a.toLowerCase():-1<d.substr(1).search(/[A-Z]|\../)?a:a.charAt(0).toUpperCase()+a.substr(1)})};Helpers$$module$lib$helpers.htmlize=function(a){return a.replace(" ","-").toLowerCase()};
Helpers$$module$lib$helpers.htmlToTitleCase=function(a){return titleCase(a.replace("-"," "))};Helpers$$module$lib$helpers.removeClass=function(a,b){a.classList&&b?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")};Helpers$$module$lib$helpers.hidden=function(a){switch(a){case "left":return"slideLeft";case "center":return"hideCenter";default:return""}};
Helpers$$module$lib$helpers.addClass=function(a,b){var c="string"!==typeof b?Helpers$$module$lib$helpers.flatten(arguments):arguments;for(var d=1;d<c.length;d++){var e=c[d];a.classList&&e?a.classList.add(e):a.className+=" "+e}};Helpers$$module$lib$helpers.flatten=function(a){function b(a){Array.prototype.forEach.call(a,function(a){a&&a instanceof Array?b(a):c.push(a)})}var c=[];b(a);return c};
Helpers$$module$lib$helpers.optionsFormToArray=function(a){var b=[];Array.prototype.forEach.call(a.elements,function(a){b.push(a.value)});return b};Helpers$$module$lib$helpers.otherIndexOfValue=function(a,b,c){for(var d=0;d<a.length;d++)if(a[d].value===b&&d!=c)return d;throw"index not found";};Helpers$$module$lib$helpers.where=function(a,b){b=Helpers$$module$lib$helpers.paramsMatch(b);return a.filter(b)};Helpers$$module$lib$helpers.find=function(a,b){for(var c=0;c<a.length;c++)if(b(a[c]))return a[c]};
Helpers$$module$lib$helpers.findWhere=function(a,b){b=Helpers$$module$lib$helpers.paramsMatch(b);return Helpers$$module$lib$helpers.find(a,b)};Helpers$$module$lib$helpers.paramsMatch=function(a){return function(b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]!==b[c])return!1;return!0}};Helpers$$module$lib$helpers.findIndex=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1};Helpers$$module$lib$helpers.reject=function(a,b){return a.filter(function(a){return!b(a)})};
Helpers$$module$lib$helpers.shuffle=function(a){for(var b,c=a.slice(),d=c.length-1;0<d;d--)a=Math.floor(Math.random()*d),b=c[d],c[d]=c[a],c[a]=b;return c};Helpers$$module$lib$helpers.createDOMElement=function(a){var b,c=document.createElement(a.type);for(b in a.attributes)c[b]=a.attributes[b];for(b in a.nonStandardAttributes)c.setAttribute(b,a.nonStandardAttributes[b]);a.classes&&Helpers$$module$lib$helpers.addClass(c,a.classes);return c};var module$lib$helpers={};module$lib$helpers.Helpers=Helpers$$module$lib$helpers;var Card$$module$lib$card=function(a){for(var b=$jscomp.makeIterator(Object.keys(a)),c=b.next();!c.done;c=b.next())this.setProperty(a,c.value);this.cost=new Cost$$module$lib$cost(a)};Card$$module$lib$card.constructCard=function(a){return"Alchemy"===a.set?new AlchemyCard$$module$lib$card(a):new Card$$module$lib$card(a)};Card$$module$lib$card.constructProperty=function(a,b){a=a[b];return"N"===a?!1:"Y"===a?!0:"name"===b?Helpers$$module$lib$helpers.titleCase(a):a};
Card$$module$lib$card.prototype.setProperty=function(a,b){"cost"!==b&&"debtCost"!==b&&"potionCost"!==b&&(this[b]=Card$$module$lib$card.constructProperty(a,b))};Card$$module$lib$card.prototype.isPotionCard=function(){return this.cost.potion};Card$$module$lib$card.prototype.compareCost=function(a){return this.cost.compareCost(a.cost)};Card$$module$lib$card.prototype.costString=function(){return this.cost.costString()};Card$$module$lib$card.prototype.getCoinCost=function(){return this.cost.coinCost};
Card$$module$lib$card.prototype.getDebtCost=function(){return this.cost.debtCost};Card$$module$lib$card.prototype.hasZeroCost=function(){return this.cost.isZero()};Card$$module$lib$card.prototype.kingdomCompare=function(a,b){return this.set===b?a.kingdom===b?0:1:a.kingdom===b?-1:0};Card$$module$lib$card.prototype.processRemoval=function(a){this.checkAndRemoveYoungWitchAndBane(a);this.cardDisplay.processRemoval({default:!1})};
Card$$module$lib$card.prototype.constructCardName=function(a){a=a||{};var b=this.name;this===a.bane&&(b+=" (bane)");return b};Card$$module$lib$card.prototype.hasExtraCards=function(){return this.extraPile&&"Bane"!=this.extraPile};Card$$module$lib$card.prototype.hide=function(a){this.cardDisplay.hide(a)};Card$$module$lib$card.prototype.unhide=function(a){this.cardDisplay.unhide(a)};Card$$module$lib$card.prototype.addToSelected=function(a){this.unhide(a.direction);a.selectedCards.push(this)};
Card$$module$lib$card.prototype.setDisplay=function(a){this.cardDisplay=a};Card$$module$lib$card.prototype.el=function(){return this.cardDisplay.el};Card$$module$lib$card.prototype.updateCardDisplay=function(a){this.cardDisplay.updateDisplay(a)};Card$$module$lib$card.prototype.hasCost=function(){return!this.cost.isNull()};Card$$module$lib$card.prototype.processUnveto=function(a){this.unhide({default:!1});this.checkYoungWitchUnveto(a);this.updateCardDisplay(a)};
Card$$module$lib$card.prototype.removeThroughUnveto=function(a){this.hide({default:!0});this.checkToRemoveBane(a)};Card$$module$lib$card.prototype.checkAndRemoveYoungWitchAndBane=function(a){this.isYoungWitch()?a.removeBaneCard():this===a.bane&&(a.addReplacementBaneCard(),a.currentCards.push(this))};Card$$module$lib$card.prototype.isYoungWitch=function(){return"Young Witch"===this.name};
Card$$module$lib$card.prototype.meetsBaneCost=function(){return!this.isPotionCard()&&2<=this.cost.getCoinCost()&&3>=this.cost.getCoinCost()};Card$$module$lib$card.prototype.checkYoungWitchUnveto=function(a){this.isYoungWitch()&&a.unvetoBane()};Card$$module$lib$card.prototype.checkToRemoveBane=function(a){this.isYoungWitch()&&a.removeBaneCard(!0)};var AlchemyCard$$module$lib$card=function(a){Card$$module$lib$card.call(this,a)};$jscomp.inherits(AlchemyCard$$module$lib$card,Card$$module$lib$card);
AlchemyCard$$module$lib$card.constructProperty=Card$$module$lib$card.constructProperty;AlchemyCard$$module$lib$card.constructCard=Card$$module$lib$card.constructCard;AlchemyCard$$module$lib$card.addToSelected=function(a){var b=a.game;Card$$module$lib$card.prototype.addToSelected.call(this,a);a.game.needsMoreAlchemy()&&(3>=b.minBySet.Alchemy&&(b.minBySet.Alchemy=3),b.selectnCardsFromSet("Alchemy",3))};var module$lib$card={};module$lib$card.Card=Card$$module$lib$card;var Transitions$$module$lib$dominionator_transitions=function(){};Transitions$$module$lib$dominionator_transitions.whichTransitionEvent=function(){var a=document.createElement("fakeelement"),b={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",MSTransition:"MSAnimationEnd"},c;for(c in b)if(void 0!==a.style[c])return b[c]};
Transitions$$module$lib$dominionator_transitions.addTransitionEvent=function(a,b){Transitions$$module$lib$dominionator_transitions.createSelfDestroyingListener(a,Transitions$$module$lib$dominionator_transitions.whichTransitionEvent(),b)};Transitions$$module$lib$dominionator_transitions.createSelfDestroyingListener=function(a,b,c){var d=function(e){c(e);a.removeEventListener(b,d)};a.addEventListener(b,d)};var module$lib$dominionator_transitions={};module$lib$dominionator_transitions.Transitions=Transitions$$module$lib$dominionator_transitions;var CardDisplay$$module$lib$card_display=function(a){this.card=a.card;this.gameDisplay=a.gameDisplay;this.selector=a.selector;this.card.isPotionCard()&&(this.potionImg=a.potionImg.cloneNode());this.constructNode();this.attachDisplayToNodes();this.card.setDisplay(this)};CardDisplay$$module$lib$card_display.prototype.idHtml=function(){return"dominionator-card-"+this.card.id};CardDisplay$$module$lib$card_display.prototype.nameIdHtml=function(){return"dominionator-card-name-"+this.card.id};
CardDisplay$$module$lib$card_display.prototype.constructNode=function(){this.el=Helpers$$module$lib$helpers.createDOMElement({type:"li",attributes:{id:this.idHtml()}});this.createTextSpan();this.el.appendChild(this.textSpanElement);this.createCardAttributes();this.vetoButtonElement=this.createVetoButton();this.el.appendChild(this.vetoButtonElement);this.hide({default:!0})};
CardDisplay$$module$lib$card_display.prototype.createTextSpan=function(){this.textSpanElement=Helpers$$module$lib$helpers.createDOMElement({type:"span",classes:["dominionator-card-name"],attributes:{id:this.nameIdHtml(),innerHTML:this.selector.constructCardName(this.card)}})};CardDisplay$$module$lib$card_display.prototype.createCardAttributes=function(){this.addCost();this.el.insertAdjacentHTML("beforeend","<span class='dominionator-set-name'>"+this.card.set+"</span>")};
CardDisplay$$module$lib$card_display.prototype.addCost=function(){var a=document.createElement("span");this.addNumCost(a);this.addPotionCost(a);this.el.appendChild(a)};
CardDisplay$$module$lib$card_display.prototype.addNumCost=function(a){if(this.card.hasCost()){if(this.card.hasZeroCost())var b="0";else{var c=this.card.getCoinCost(),d=this.card.getDebtCost();b="";c&&(b+=c);b&&d&&(b+=" ");d&&(b+=d+"D")}b=Helpers$$module$lib$helpers.createDOMElement({type:"span",attributes:{innerText:b},classes:["dominionator-card-cost-num"]});this.card.isPotionCard()||Helpers$$module$lib$helpers.addClass(b,"dominionator-card-cost-num-no-img");a.appendChild(b)}};
CardDisplay$$module$lib$card_display.prototype.addPotionCost=function(a){this.card.isPotionCard()&&(0===this.card.getCoinCost()&&Helpers$$module$lib$helpers.addClass(this.potionImg,"dominionator-potion-img-no-text"),a.appendChild(this.potionImg))};CardDisplay$$module$lib$card_display.prototype.createVetoButton=function(){return Helpers$$module$lib$helpers.createDOMElement({type:"button",classes:["veto-button","dominionator-veto"],attributes:{id:"dominionator-veto-button-"+this.card.id,innerText:"Veto"}})};
CardDisplay$$module$lib$card_display.prototype.attachDisplayToNodes=function(){this.textSpanElement.cardDisplay=this;this.vetoButtonElement.cardDisplay=this;this.card.cardDisplay=this};CardDisplay$$module$lib$card_display.prototype.updateDisplay=function(a){this.updateHiddenStatus(a);this.isHidden||(this.textSpanElement.innerHTML=this.constructCardHTML(a))};
CardDisplay$$module$lib$card_display.prototype.constructCardHTML=function(a){a=this.card.constructCardName(a);this.card.hasExtraCards()&&(a+="<br><small>(with "+this.card.extraPile+")</small>");return a};CardDisplay$$module$lib$card_display.prototype.hide=function(a){this.isHidden||!a||void 0===a.default||a.default?this.slideLeft():this.slideRight();this.isHidden=!0};
CardDisplay$$module$lib$card_display.prototype.unhide=function(a){!this.isHidden&&void 0!==this.isHidden||!a||void 0===a.default||a.default?this.removeHiddenClasses():this.unhideRight();this.isHidden=!1};CardDisplay$$module$lib$card_display.prototype.unhideRight=function(){var a=this;this.teleportRight();window.setTimeout(function(){a.removeHiddenClasses()},100)};
CardDisplay$$module$lib$card_display.prototype.removeHiddenClasses=function(){Helpers$$module$lib$helpers.removeClass(this.el,"slideLeft");Helpers$$module$lib$helpers.removeClass(this.el,"slideRight")};CardDisplay$$module$lib$card_display.prototype.teleportLeft=function(){this.teleport("left")};CardDisplay$$module$lib$card_display.prototype.teleportRight=function(a){this.teleport("right")};
CardDisplay$$module$lib$card_display.prototype.teleport=function(a){Helpers$$module$lib$helpers.addClass(this.el,"noMove");Helpers$$module$lib$helpers.removeClass(this.el,"right"===a?"slideLeft":"slideRight");Helpers$$module$lib$helpers.addClass(this.el,"right"===a?"slideRight":"slideLeft");Helpers$$module$lib$helpers.removeClass(this.el,"noMove")};
CardDisplay$$module$lib$card_display.prototype.slideLeft=function(){Helpers$$module$lib$helpers.removeClass(this.el,"slideRight");Helpers$$module$lib$helpers.removeClass(this.el,"noMove");Helpers$$module$lib$helpers.addClass(this.el,"slideLeft")};
CardDisplay$$module$lib$card_display.prototype.slideRight=function(){var a=this.el;Transitions$$module$lib$dominionator_transitions.addTransitionEvent(a,this.teleportLeft.bind(this));Helpers$$module$lib$helpers.removeClass(a,"slideLeft");Helpers$$module$lib$helpers.removeClass(a,"noMove");Helpers$$module$lib$helpers.addClass(a,"slideRight")};CardDisplay$$module$lib$card_display.prototype.processRemoval=function(a){this.hide(a)};
CardDisplay$$module$lib$card_display.prototype.updateHiddenStatus=function(a){a.includesCard(this.card)?this.unhide({default:!0}):this.isHidden?this.hide({default:!0}):this.hide({default:!1})};var module$lib$card_display={};module$lib$card_display.CardDisplay=CardDisplay$$module$lib$card_display;var Sorter$$module$lib$sorter=function(){};Sorter$$module$lib$sorter.sortByProperties=function(a,b){b=Sorter$$module$lib$sorter.constructSorter(b);return a.sort(b)};Sorter$$module$lib$sorter.constructSorter=function(a,b){return function(c,d){for(var e,f=0;f<a.length;f++)if(e=Sorter$$module$lib$sorter.compareProperty(c,d,a[f],b))return e;return 0}};
Sorter$$module$lib$sorter.compareProperty=function(a,b,c,d){return"cost"===c?a.compareCost(b):"moveKingdomToFront"===c?a.kingdomCompare(b,d):a[c]>b[c]?1:a[c]<b[c]?-1:0};var module$lib$sorter={};module$lib$sorter.Sorter=Sorter$$module$lib$sorter;var CardList$$module$lib$card_list=function(){this.byName={};this.sets=[]};CardList$$module$lib$card_list.prototype.initializeCards=function(a){var b=new XMLHttpRequest;a=this.loadCardsFunction(a);b.addEventListener("load",a,!1);b.open("GET","dominion_cards.csv",!0);b.send()};
CardList$$module$lib$card_list.prototype.loadCardsFunction=function(a){var b=this;return function(c){Papa.parse(c.currentTarget.response,{header:!0,dynamicTyping:!0,complete:function(c){for(var d=0;d<c.data.length;d++)b.loadOneCard(c.data[d]);b.constructAllCards();a.call()}})}};
CardList$$module$lib$card_list.prototype.loadOneCard=function(a){a=Card$$module$lib$card.constructCard(a);a.name&&!a.isDeprecated&&(void 0===this[a.set]?(this[a.set]=[a],this.sets.push(a.set)):this[a.set].push(a),this.byName[a.name]=a)};CardList$$module$lib$card_list.prototype.constructAllCards=function(){var a=this;this.allCards=[];this.sets.forEach(function(b){a.allCards=a.allCards.concat(a[b])})};CardList$$module$lib$card_list.prototype.resetKingdom=function(){this.resetCards(this.allCards)};
CardList$$module$lib$card_list.prototype.resetCards=function(a){a&&a.forEach(function(a){a.hide({default:!0})})};CardList$$module$lib$card_list.prototype.sortKingdomCards=function(a){this.allCards=Sorter$$module$lib$sorter.sortByProperties(this.allCards,a)};CardList$$module$lib$card_list.prototype.findOneCardByName=function(a){return a?Helpers$$module$lib$helpers.findWhere(this.allCards,{name:a}):!1};
CardList$$module$lib$card_list.prototype.findCardsByName=function(a){var b=this,c=[];a.forEach(function(a){c.push(b.findOneCardByName(a))});return c};CardList$$module$lib$card_list.prototype.updateHiddenStatus=function(a){this.allCards.forEach(function(b){a.includesCard(b)?b.unhide():b.hide({default:!0})})};CardList$$module$lib$card_list.prototype.hideNotInKingdom=function(a){a.includesCard(card)||card.hide({default:!0})};
CardList$$module$lib$card_list.prototype.displayInKingdom=function(a){a.includesCard(card)&&card.unhide({default:!0})};var module$lib$card_list={};module$lib$card_list.CardList=CardList$$module$lib$card_list;var CardSelectLi$$module$lib$card_select_form_li=function(a){this.setName=a;this.createNode();this.createSelectBoxes();this.createIncludeExcludeBoxes();this.createAlchemyOptionBox();this.lastMin=0;this.lastMax=10};
CardSelectLi$$module$lib$card_select_form_li.prototype.createNode=function(){this.el=Helpers$$module$lib$helpers.createDOMElement({type:"li",classes:["dominionator-select-li"],attributes:{id:"dominionator-"+Helpers$$module$lib$helpers.htmlize(this.setName)+"-id"}});this.groupNode=Helpers$$module$lib$helpers.createDOMElement({type:"div",classes:["group"]});this.el.appendChild(this.groupNode)};
CardSelectLi$$module$lib$card_select_form_li.prototype.createSelectBoxes=function(){this.minOption=this.createSelectOption("min");this.minOption.selectLi=this;var a=this.wrapSelector(this.minOption);this.maxOption=this.createSelectOption("max");this.maxOption.selectLi=this;var b=this.wrapSelector(this.maxOption),c=this.createNameElement();this.groupNode.appendChild(a);this.groupNode.appendChild(c);this.groupNode.appendChild(b)};
CardSelectLi$$module$lib$card_select_form_li.prototype.createNameElement=function(){return Helpers$$module$lib$helpers.createDOMElement({type:"span",classes:["dominionator-set-name","dominionator-set-column"],attributes:{innerText:this.setName+" "}})};
CardSelectLi$$module$lib$card_select_form_li.prototype.createSelectOption=function(a){for(var b=Helpers$$module$lib$helpers.createDOMElement({type:"select",classes:["dominionator-option"],attributes:{id:Helpers$$module$lib$helpers.htmlize(this.setName)+"-"+a}}),c=0;10>=c;c++){var d=Helpers$$module$lib$helpers.createDOMElement({type:"option",attributes:{innerText:c}});b.appendChild(d)}b.value="min"===a?0:10;return b};
CardSelectLi$$module$lib$card_select_form_li.prototype.wrapSelector=function(a){var b=Helpers$$module$lib$helpers.createDOMElement({type:"span",classes:["dominionator-min-max-column"]});b.appendChild(a);return b};CardSelectLi$$module$lib$card_select_form_li.prototype.validateIncludeExclude=function(){!parseInt(this.maxOption.value)&&this.includeOption.checked?this.excludeOption.checked=!0:parseInt(this.maxOption.value)&&this.excludeOption.checked&&(this.includeOption.checked=!0)};
CardSelectLi$$module$lib$card_select_form_li.prototype.validateInput=function(a,b){this.hasBeenSet=!0;switch(a){case this.minOption:this.validateMax();this.rememberInput();this.validateIncludeExclude();break;case this.maxOption:this.validateMin();this.rememberInput();this.validateIncludeExclude();break;case this.includeOption:b.includeSet(this);break;case this.excludeOption:b.excludeSet(this);break;case this.alchemyCheckbox:this.validateAlchemy(b)}};
CardSelectLi$$module$lib$card_select_form_li.prototype.validateMax=function(){parseInt(this.maxOption.value)<parseInt(this.minOption.value)&&(this.maxOption.value=this.minOption.value)};CardSelectLi$$module$lib$card_select_form_li.prototype.validateMin=function(){parseInt(this.minOption.value)>parseInt(this.maxOption.value)&&(this.minOption.value=this.maxOption.value);this.validateUncheckAlchemy()};
CardSelectLi$$module$lib$card_select_form_li.prototype.rememberInput=function(){this.lastMin=parseInt(this.minOption.value);this.lastMax=parseInt(this.maxOption.value)};CardSelectLi$$module$lib$card_select_form_li.prototype.changeSetInclusion=function(a){"include"===a?(this.includeOption.checked=!0,this.minOption.value=this.lastMin,this.maxOption.value=parseInt(this.maxOption.value)||this.lastMax):(this.excludeOption.checked=!0,this.maxOption.value=0,this.minOption.value=0)};
CardSelectLi$$module$lib$card_select_form_li.prototype.createIncludeExcludeBoxes=function(){var a=this.createIncludeExclude("include"),b=this.createIncludeExclude("exclude");this.groupNode.appendChild(a);this.groupNode.appendChild(b)};
CardSelectLi$$module$lib$card_select_form_li.prototype.createIncludeExclude=function(a){var b="dominionator-"+Helpers$$module$lib$helpers.htmlize(this.setName)+"-"+a,c=Helpers$$module$lib$helpers.createDOMElement({type:"div",classes:["dominionator-option","dominionator-include-exclude-column"]});b=Helpers$$module$lib$helpers.createDOMElement({type:"input",classes:[a+"-radio"],attributes:{type:"radio",name:this.setName,value:a,id:b,selectLi:this}});this[a+"Option"]=b;c.appendChild(b);return c};
CardSelectLi$$module$lib$card_select_form_li.prototype.createAlchemyOptionBox=function(){if("Alchemy"===this.setName){var a=Helpers$$module$lib$helpers.createDOMElement({type:"li",classes:["alchemy-condition-li"]}),b=Helpers$$module$lib$helpers.createDOMElement({type:"label",attributes:{for:"dominionator-alchemy-condition-checkbox",innerText:"Require at least three Alchemy cards if any are chosen."}}),c=Helpers$$module$lib$helpers.createDOMElement({type:"input",classes:["dominionator-alchemy-condition-checkbox"],
attributes:{type:"checkbox",id:"dominionator-alchemy-condition-checkbox",selectLi:this}});b.insertBefore(c,b.firstChild);a.appendChild(b);this.alchemyCheckbox=c;this.alchemyCheckboxLi=a}};CardSelectLi$$module$lib$card_select_form_li.prototype.validateAlchemy=function(){var a=parseInt(this.maxOption.value);this.alchemyCheckbox.checked&&a&&(this.maxOption.value=Math.max(a,3),this.rememberInput())};
CardSelectLi$$module$lib$card_select_form_li.prototype.validateUncheckAlchemy=function(){this.alchemyCheckbox&&3>parseInt(this.maxOption.value)&&(this.alchemyCheckbox.checked=!1)};var module$lib$card_select_form_li={};module$lib$card_select_form_li.CardSelectLi=CardSelectLi$$module$lib$card_select_form_li;var NewGameForm$$module$lib$card_select_form=function(a){this.selector=a.selector;this.cardList=this.selector.cardList;this.el=a.el;this.shouldSetIncludeExclude=!0;this.liObjects=[];this.liObjectsBySetName={};this.domObjectsById={}};NewGameForm$$module$lib$card_select_form.prototype.initializeForm=function(){this.createForm();this.setLiListeners();this.setSubmitListener()};NewGameForm$$module$lib$card_select_form.prototype.createForm=function(){this.createHeader();this.setListItems();this.createInputBox()};
NewGameForm$$module$lib$card_select_form.prototype.createHeader=function(){var a=Helpers$$module$lib$helpers.createDOMElement({type:"div",attributes:{innerHTML:"<span class='dominionator-min-max-column'>Min</span>        <span class='dominionator-set-column'>Set</span>        <span class='dominionator-min-max-column'>Max</span>        <span class='dominionator-include-exclude-column'>Include</span>        <span class='dominionator-include-exclude-column'>Exclude</span>"}});Helpers$$module$lib$helpers.addClass(a,
"select-form-header");this.el.appendChild(a)};NewGameForm$$module$lib$card_select_form.prototype.setListItems=function(){var a=this,b,c=Helpers$$module$lib$helpers.createDOMElement({type:"ul",classes:["dominionator-select-ul","standard-left-margin-padding"]});this.liObjects=[];this.el.appendChild(c);this.cardList.sets.sort().forEach(function(d){d=new CardSelectLi$$module$lib$card_select_form_li(d);a.liObjects.push(d);c.appendChild(d.el);d.alchemyCheckboxLi&&(b=d.alchemyCheckboxLi)});c.appendChild(b)};
NewGameForm$$module$lib$card_select_form.prototype.createInputBox=function(){var a=Helpers$$module$lib$helpers.createDOMElement({type:"input",classes:["dominionator-submit-button"],attributes:{type:"submit",value:"New Set"}});this.el.appendChild(a)};NewGameForm$$module$lib$card_select_form.prototype.setLiListeners=function(){var a=this;this.el.addEventListener("change",function(b){b=b.target;b.selectLi.validateInput(b,a)})};NewGameForm$$module$lib$card_select_form.prototype.getDomObjectByTarget=function(a){return this.domObjectsById[a.id]};
NewGameForm$$module$lib$card_select_form.prototype.setSubmitListener=function(){var a=this;this.el.addEventListener("submit",function(b){b.preventDefault();b=a.findMinMax("min");var c=a.findMinMax("max"),d=a.checkAlchemyCondition();a.selector.createNewGame({minBySet:b,maxBySet:c,alchemy_min_3:d})})};NewGameForm$$module$lib$card_select_form.prototype.includeSet=function(a){this.shouldSetIncludeExclude&&(this.shouldSetIncludeExclude=!1,this.excludeAllExcept(a));this.changeSetInclusion("include",a)};
NewGameForm$$module$lib$card_select_form.prototype.excludeSet=function(a){this.shouldSetIncludeExclude&&(this.shouldSetIncludeExclude=!1,this.includeAllExcept(a));this.changeSetInclusion("exclude",a)};NewGameForm$$module$lib$card_select_form.prototype.includeAll=function(){var a=this,b=document.querySelectorAll("input[name=include-checkbox]");Array.prototype.forEach.call(b,function(b){a.includeSet(b.setName)})};NewGameForm$$module$lib$card_select_form.prototype.changeSetInclusion=function(a,b){b.changeSetInclusion(a)};
NewGameForm$$module$lib$card_select_form.prototype.includeAllExcept=function(a){var b=this;this.liObjects.forEach(function(c){a!=c&&b.includeSet(c)})};NewGameForm$$module$lib$card_select_form.prototype.excludeAllExcept=function(a){var b=this;this.liObjects.forEach(function(c){c!=a&&b.excludeSet(c)})};
NewGameForm$$module$lib$card_select_form.prototype.findMinMax=function(a){var b={};this.cardList.sets.forEach(function(c){var d=Helpers$$module$lib$helpers.htmlize(c)+"-"+a;b[c]=document.getElementById(d).value});return b};NewGameForm$$module$lib$card_select_form.prototype.updateAlchemyBox=function(a,b){var c=document.getElementById("dominionator-alchemy-condition-checkbox");"Alchemy"===a&&(c.el.checked=b)};
NewGameForm$$module$lib$card_select_form.prototype.setAlchemyConditionListener=function(){var a=this;document.getElementById("dominionator-alchemy-condition-checkbox").addEventListener("change",function(b){b=b.target;var c=document.getElementById("alchemy-exclude");b.checked?(a.includeSet("Alchemy"),c.checked=!1):c.checked||a.includeSet("Alchemy")})};NewGameForm$$module$lib$card_select_form.prototype.checkAlchemyCondition=function(){return document.getElementById("dominionator-alchemy-condition-checkbox").checked};
var module$lib$card_select_form={};module$lib$card_select_form.NewGameForm=NewGameForm$$module$lib$card_select_form;var Game$$module$lib$game=function(a,b,c,d){this.cardList=a;this.alchemy_min_3=b||!1;this.sets=this.cardList.sets;this.byName={};this.maxCards=10;this.gameDisplay=c;this.rejectedCards=[];this.id=d};Game$$module$lib$game.countBySet=function(a,b){return a.reduce(function(a,d,e,f){return a+(d.set===b?1:0)},0)};
Game$$module$lib$game.convertFromHistory=function(a){var b=a.cardList,c=new Game$$module$lib$game(b),d=a.gameState;c.kingdomCards=b.findCardsByName(d.kingdomCards);c.eventsAndLandmarks=b.findCardsByName(d.eventsAndLandmarks);c.vetoed=b.findCardsByName(d.vetoed);c.currentCards=b.findCardsByName(d.currentCards);c.bane=b.findOneCardByName(d.bane);c.maxCards=parseInt(d.maxCards);c.platCol=d.platCol;c.shelters=d.shelters;c.maxBySet=d.maxBySet;c.minBySet=d.minBySet;c.id=d.id;c.gameDisplay=a.gameDisplay;
return c};Game$$module$lib$game.prototype.constructCurrentCards=function(){this.currentCards=[];var a=this.options.sets||this.cardList.sets;this.setMinMax();for(var b=0;b<a.length;b++)this.currentCards=this.currentCards.concat(this.cardList[a[b]]);this.options.banned&&(banned_cards=this.constructCardsByName(this.options.banned),this.currentCards=Helpers$$module$lib$helpers.reject(this.currentCards,function(a){return void 0!==Helpers$$module$lib$helpers.findWhere(banned_cards,{name:a.name})}))};
Game$$module$lib$game.prototype.constructCardsByName=function(a){var b=this;return a.map(function(a){return b.byName[a]})};Game$$module$lib$game.prototype.selectCards=function(a){a=a||{};this.selectRandomCards(a)};Game$$module$lib$game.prototype.selectRandomCards=function(a){this.options=a||{};void 0===this.options.chooseEvents&&(this.options.chooseEvents=!0);this.constructCurrentCards();this.selectKingdomCards(this.options.chooseEvents);this.selectSheltersPlatCol()};
Game$$module$lib$game.prototype.includesCondition=function(a){for(var b=$jscomp.makeIterator(this.kingdomCards),c=b.next();!c.done;c=b.next())if(c.value[a])return!0;return!1};Game$$module$lib$game.prototype.includesRuins=function(){return this.includesCondition("ruins")};Game$$module$lib$game.prototype.includesSpoils=function(){return this.includesCondition("spoils")};
Game$$module$lib$game.prototype.setMinMax=function(){var a=this;this.options.minBySet=this.options.minBySet||{};this.options.maxBySet=this.options.maxBySet||{};this.minBySet={};this.maxBySet={};this.sets.forEach(function(b){a.minBySet[b]=a.options.minBySet[b]||0;a.maxBySet[b]=a.options.maxBySet[b]||11;a.maxBySet[b]<a.minBySet[b]&&(a.maxBySet[b]=11)})};Game$$module$lib$game.prototype.eventClass=function(){return 0<this.eventsAndLandmarks.length?"":Helpers$$module$lib$helpers.hidden()};
Game$$module$lib$game.prototype.landmarkClass=function(){return 0<this.eventsAndLandmarks.length?"":Helpers$$module$lib$helpers.hidden()};Game$$module$lib$game.prototype.includesCard=function(a){return 0<=this.kingdomCards.indexOf(a)||0<=this.eventsAndLandmarks.indexOf(a)};Game$$module$lib$game.prototype.alchemyConditionMet=function(){var a=this.numAlchemyCards();return 3<=a&&4>=a};
Game$$module$lib$game.prototype.needsMoreAlchemy=function(){var a=this.numAlchemyCards();return this.alchemy_min_3&&3>a&&2<=this.maxCards-this.numAlchemyCards()};Game$$module$lib$game.prototype.numAlchemyCards=function(){return Helpers$$module$lib$helpers.where(this.kingdomCards,{set:"Alchemy"}).length};Game$$module$lib$game.prototype.hasPotionCard=function(){return Helpers$$module$lib$helpers.find(this.kingdomCards,function(a){return a.isPotionCard&&a.isPotionCard()})};
Game$$module$lib$game.prototype.selectKingdomCards=function(a){this.kingdomCards=[];this.eventsAndLandmarks=[];this.vetoed=[];this.updateKingdomCards(a)};
Game$$module$lib$game.prototype.updateKingdomCards=function(a){a=a||!1;this.currentCards=Helpers$$module$lib$helpers.shuffle(this.currentCards);for(this.selectCardsFromEachSet(this.minBySet,a);this.kingdomCards.length<this.maxCards&&0<this.currentCards.length;)this.trySelectOneCard(a);this.processSpecialCases();this.currentCards=this.currentCards.concat(this.rejectedCards);this.rejectedCards=[]};
Game$$module$lib$game.prototype.selectCardsFromEachSet=function(a,b){for(var c in a)0!==parseInt(a[c])&&this.selectnCardsFromSet(c,a[c],b)};
Game$$module$lib$game.prototype.selectnCardsFromSet=function(a,b,c){for(var d=Helpers$$module$lib$helpers.shuffle(Helpers$$module$lib$helpers.where(this.currentCards,{set:a})),e=[],f=Helpers$$module$lib$helpers.reject(this.currentCards,function(b){return b.set===a});0<d.length&&0<b-this.numCardsInSet(a)&&10>this.kingdomCards.length;){var g=d.pop();if(this.isValidKingdomCard(g))g.addToSelected({selectedCards:this.kingdomCards,game:this});else if(this.isValidEventOrLandmark(g,c)&&(!f.length||Math.random()<
d.length/f.length)){var h=void 0;if(g.isEvent||g.isLandmark)h=this.eventsAndLandmarks;g.addToSelected({selectedCards:h})}else e.push(g)}this.currentCards=Helpers$$module$lib$helpers.shuffle(d.concat(f).concat(e))};Game$$module$lib$game.prototype.numCardsInSet=function(a){return Helpers$$module$lib$helpers.where(this.kingdomCards,{set:a}).length};
Game$$module$lib$game.prototype.trySelectOneCard=function(a){var b=this.currentCards.pop();this.isValidEventOrLandmark(b,a)?b.addToSelected({selectedCards:this.eventsAndLandmarks}):this.isValidKingdomCard(b)?b.addToSelected({selectedCards:this.kingdomCards,game:this}):this.rejectedCards.push(b)};Game$$module$lib$game.prototype.isValidEventOrLandmark=function(a,b){return a.isEvent&&!b?!1:2<=this.eventsAndLandmarks.length?!1:this.isValidEvent(a)||this.isValidLandmark(a)};
Game$$module$lib$game.prototype.isValidEvent=function(a){return a.isEvent&&!this.isVetoedCard(a)&&0>this.eventsAndLandmarks.indexOf(a)&&Game$$module$lib$game.countBySet(this.allCardsInGame(),a.set)<this.maxBySet[a.set]};Game$$module$lib$game.prototype.isValidKingdomCard=function(a){return a.isKingdomCard&&!this.isVetoedCard(a)&&0>this.kingdomCards.indexOf(a)&&Game$$module$lib$game.countBySet(this.allCardsInGame(),a.set)<this.maxBySet[a.set]};
Game$$module$lib$game.prototype.isValidLandmark=function(a){return a.isLandmark&&!this.isVetoedCard(a)&&0>this.eventsAndLandmarks.indexOf(a)&&Game$$module$lib$game.countBySet(this.allCardsInGame(),a.set)<this.maxBySet[a.set]};Game$$module$lib$game.prototype.allCardsInGame=function(){return this.kingdomCards.concat(this.eventsAndLandmarks)};Game$$module$lib$game.prototype.selectSheltersPlatCol=function(){this.shelters=this.selectShelters(this.options);this.platCol=this.selectPlatCol(this.options)};
Game$$module$lib$game.prototype.selectRandomCard=function(){return this.currentCards.pop()};Game$$module$lib$game.prototype.selectShelters=function(){if(void 0===this.options.shelters){var a=Game$$module$lib$game.countBySet(this.kingdomCards,"Dark Ages")/10;return Math.random()<=a}return this.options.shelters};Game$$module$lib$game.prototype.selectPlatCol=function(){if(void 0===this.options.platCol){var a=Game$$module$lib$game.countBySet(this.kingdomCards,"Prosperity")/10;return Math.random()<=a}return this.options.platCol};
Game$$module$lib$game.prototype.isVetoedCard=function(a){return 0<=this.vetoed.indexOf(a)};Game$$module$lib$game.prototype.veto=function(a){a.isEvent?0<=(a=this.eventsAndLandmarks.indexOf(a))&&(this.gameDisplay.updateVetoDisplay("event"),this.vetoAndReplaceEventByIndex(a)):(a=this.kingdomCards.indexOf(a),0<=a&&(this.gameDisplay.updateVetoDisplay("kingdom"),this.vetoCardByIndex(a),this.updateKingdomCards()))};
Game$$module$lib$game.prototype.vetoCardByIndex=function(a,b){b=b||this.kingdomCards;var c=b[a];b.splice(a,1);this.vetoed.push(c);c.processRemoval(this)};Game$$module$lib$game.prototype.vetoAndReplaceEventByIndex=function(a){this.vetoCardByIndex(a,this.eventsAndLandmarks);this.addNewEvent()};Game$$module$lib$game.prototype.addNewEvent=function(){this.addNewEventOrLandmark("events")};Game$$module$lib$game.prototype.addNewLandmark=function(){this.addNewEventOrLandmark("landmarks")};
Game$$module$lib$game.prototype.addNewEventOrLandmark=function(a){if("events"===a){var b={isEvent:!0};var c={isEvent:!1};var d=this.isValidEvent}else"landmarks"===a&&(b={isLandmark:!0},c={isLandmark:!1},d=this.isValidLandmark);if(a){b=Helpers$$module$lib$helpers.where(this.currentCards,b);for(var e=Helpers$$module$lib$helpers.where(this.currentCards,c);0<b.length;)if(c=b.pop(),d(c)){c.addToSelected({selectedCards:this[a]});break}this.currentCards=Helpers$$module$lib$helpers.shuffle(e.concat(b))}};
Game$$module$lib$game.prototype.unveto=function(){var a=this.vetoed.pop(),b=this.getLastCardAdded(a);b===this.bane&&(this.bane=a,this.lastBane=!1);this.removeCardThroughUnveto(b);this.readdCard(a)};Game$$module$lib$game.prototype.getLastCardAdded=function(a){return a.isEvent?this.eventsAndLandmarks.pop():this.kingdomCards.pop()};Game$$module$lib$game.prototype.readdCard=function(a){a.isEvent?this.eventsAndLandmarks.push(a):this.kingdomCards.push(a);a.processUnveto(this)};
Game$$module$lib$game.prototype.removeCardThroughUnveto=function(a){this.currentCards.push(a);a.removeThroughUnveto(this)};Game$$module$lib$game.prototype.processSpecialCases=function(){this.processYoungWitch()};Game$$module$lib$game.prototype.processYoungWitch=function(){this.kingdomCards.length<=this.maxCards&&!this.kingdomCards.every(function(a){return!a.isYoungWitch()})&&!this.bane&&this.addBaneCard()};Game$$module$lib$game.prototype.addReplacementBaneCard=function(){--this.maxCards;this.addBaneCard()};
Game$$module$lib$game.prototype.addBaneCard=function(){for(var a=0,b;200>a;)if(b=this.selectRandomCard(),this.isValidKingdomCard(b)&&b.meetsBaneCost()){this.addBaneToKingdom({card:b,direction:"left"});break}else if(a+=1,this.currentCards.unshift(b),200<=a)throw"unable to find cards satsifying conditions";};
Game$$module$lib$game.prototype.addBaneToKingdom=function(a){a.card.addToSelected({selectedCards:this.kingdomCards,direction:a.direction});this.bane=a.card;this.bane.updateCardDisplay(this);this.maxCards+=1};Game$$module$lib$game.prototype.unvetoBane=function(){this.lastBane&&(this.addBaneToKingdom({card:this.lastBane,direction:"right"}),this.lastBane=!1)};
Game$$module$lib$game.prototype.removeBaneCard=function(a){var b=Helpers$$module$lib$helpers.findIndex(this.kingdomCards,this.bane);0<=b&&(this.bane.hide(a),this.kingdomCards.splice(b,1),this.currentCards.push(this.bane),this.lastBane=this.bane,this.bane=!1,--this.maxCards)};var NullGame$$module$lib$game=function(){Game$$module$lib$game.call(this,[]);this.shelters=this.platCol=!1};$jscomp.inherits(NullGame$$module$lib$game,Game$$module$lib$game);NullGame$$module$lib$game.convertFromHistory=Game$$module$lib$game.convertFromHistory;
NullGame$$module$lib$game.countBySet=Game$$module$lib$game.countBySet;NullGame$$module$lib$game.prototype.includesRuins=function(){return!1};NullGame$$module$lib$game.prototype.includesSpoils=function(){return!1};NullGame$$module$lib$game.prototype.eventClass=function(){return"slideLeft"};var module$lib$game={};module$lib$game.Game=Game$$module$lib$game;module$lib$game.NullGame=NullGame$$module$lib$game;var GameDisplay$$module$lib$game_display=function(a){this.selector=a.selector;this.el=a.el;this.createSectionHeaders();this.currentGame=this.selector.currentGame;this.cardList=this.selector.cardList;this.displaysById={}};GameDisplay$$module$lib$game_display.prototype.displayCards=function(){var a=this.sortDisplay.pullSortOrder();this.cardList.sortKingdomCards(a);this.displayAllCards()};
GameDisplay$$module$lib$game_display.prototype.createSectionHeaders=function(){this.kingdomArea=this.createDomWithHeader({elementType:"section",sectionId:"dominionator-kingdom-cards-area",headerType:"h1",headerText:"Kingdom Cards",hidden:"left",headerId:"dominionator-kingdom-cards-header"});this.kingdomCardsList=this.kingdomArea.appendChild(Helpers$$module$lib$helpers.createDOMElement({type:"ul",classes:["dominionator-list","standard-left-margin-padding"]}));this.kingdomArea.appendChild(this.createUnVetoButton());
this.eventsAndLandmarksArea=this.createDomWithHeader({elementType:"section",sectionId:"dominionator-events-area",headerType:"h1",headerText:"Events/Landmarks",hidden:"left",headerId:"dominionator-events-header"});this.eventsAndLandmarksList=this.eventsAndLandmarksArea.appendChild(Helpers$$module$lib$helpers.createDOMElement({type:"ul",classes:["dominionator-list","standard-left-margin-padding"]}));this.otherSetupArea=this.createDomWithHeader({elementType:"section",sectionId:"dominionator-setup-area",
headerType:"h1",headerText:"Setup",hidden:"left",headerId:"dominionator-extra-setup-header"});Helpers$$module$lib$helpers.addClass(this.otherSetupArea,"dominionator-setup-area");this.otherSetupList=this.otherSetupArea.appendChild(Helpers$$module$lib$helpers.createDOMElement({type:"ul",classes:["dominionator-list","standard-left-margin-padding"]}));this.el.appendChild(this.otherSetupArea);this.el.appendChild(this.eventsAndLandmarksArea);this.el.appendChild(this.kingdomArea)};
GameDisplay$$module$lib$game_display.prototype.createDomWithHeader=function(a){var b=Helpers$$module$lib$helpers.hidden(a.hidden),c=Helpers$$module$lib$helpers.createDOMElement({type:a.elementType,attributes:{id:a.sectionId}});b=c.appendChild(Helpers$$module$lib$helpers.createDOMElement({type:a.headerType,classes:[b,"dominionator-heading","standard-left-margin-padding"],attributes:{id:a.headerId,innerText:a.headerText}}));a.smallText&&b.appendChild(Helpers$$module$lib$helpers.createDOMElement({type:"small",
attributes:{innerText:a.smalLText}}));return c};
GameDisplay$$module$lib$game_display.prototype.createExtraCardText=function(){var a=this.otherSetupArea.getElementsByTagName("ul")[0];this.createExtraLi({el:a,idText:"plat-col",visibleText:"Platinum and Colonies",attributeName:"platCol"});this.createExtraLi({el:a,idText:"shelters",visibleText:"Shelters",attributeName:"shelters"});this.createExtraLi({el:a,idText:"ruins",visibleText:"Ruins",attributeName:"ruins"});this.createExtraLi({el:a,idText:"spoils",visibleText:"Spoils",attributeName:"spoils"});
this.createExtraLi({el:a,idText:"potions",visibleText:"Potions",attributeName:"potions"})};
GameDisplay$$module$lib$game_display.prototype.createCardDisplays=function(a){var b,c=new Image,d=this;this.cardDisplays=[];c.src="https://s3-us-west-2.amazonaws.com/elliot-c-reed-dominion/potion.png";c.onload=function(){d.cardList.allCards.forEach(function(a){b=new CardDisplay$$module$lib$card_display({card:a,gameDisplay:d,selector:d.selector,potionImg:c});d.cardDisplays.push(b)}.bind(d));d.createExtraCardText();a()}};GameDisplay$$module$lib$game_display.prototype.displayAllCards=function(){this.cardList.allCards.forEach(function(a){this.displayOneCard(a)}.bind(this))};
GameDisplay$$module$lib$game_display.prototype.displayOneCard=function(a){a.isEvent||a.isLandmark?this.eventsAndLandmarksList.appendChild(a.el()):this.kingdomCardsList.appendChild(a.el())};GameDisplay$$module$lib$game_display.prototype.hiddenClass=function(a){return a?"":Helpers$$module$lib$helpers.hidden("left")};GameDisplay$$module$lib$game_display.prototype.constructCardName=function(a){return a.constructCardName(this.currentGame)};
GameDisplay$$module$lib$game_display.prototype.updateCardDisplay=function(a){a=a||{};var b=this.cardList.allCards;0<this.currentGame.kingdomCards.length&&this.displayArea(this.kingdomArea);for(var c=0;c<b.length;c++){var d=b[c];d.updateCardDisplay(this.currentGame)}0<this.currentGame.eventsAndLandmarks.length?this.displayArea(this.eventsAndLandmarksArea):this.hideArea(this.eventsAndLandmarksArea);this.updateExtraSetup();a.newGame&&this.hideVetoButton()};
GameDisplay$$module$lib$game_display.prototype.updateExtraSetup=function(){this.shelters.setAttribute("class",this.hiddenClass(this.currentGame.shelters));this.platCol.setAttribute("class",this.hiddenClass(this.currentGame.platCol));this.spoils.setAttribute("class",this.hiddenClass(this.currentGame.includesSpoils()));this.ruins.setAttribute("class",this.hiddenClass(this.currentGame.includesRuins()));this.potions.setAttribute("class",this.hiddenClass(this.currentGame.hasPotionCard()));document.getElementById("dominionator-extra-setup-header");
this.hiddenClass(this.currentGame.includesRuins()||this.currentGame.shelters||this.currentGame.platCol||this.currentGame.includesSpoils()||this.currentGame.hasPotionCard())?this.hideArea(this.otherSetupArea):this.displayArea(this.otherSetupArea)};GameDisplay$$module$lib$game_display.prototype.displayArea=function(a){a=a.getElementsByTagName("h1")[0]||a.getElementsByTagName("h2")[0];Helpers$$module$lib$helpers.removeClass(a,"slideLeft")};
GameDisplay$$module$lib$game_display.prototype.hideArea=function(a){a=a.getElementsByTagName("h1")[0];Helpers$$module$lib$helpers.addClass(a,"slideLeft")};GameDisplay$$module$lib$game_display.prototype.createExtraLi=function(a){var b=Helpers$$module$lib$helpers.createDOMElement({type:"li",classes:[this.hiddenClass(!1)],attributes:{id:"dominionator-display-"+a.idText,innerText:a.visibleText}});a.el.appendChild(b);this[a.attributeName]=b};
GameDisplay$$module$lib$game_display.prototype.createUnVetoButton=function(){var a=Helpers$$module$lib$helpers.createDOMElement({type:"button",classes:[this.hiddenClass(!1),"dominionator-unveto-button","standard-left-margin-margin"],attributes:{id:"dominionator-unveto-button",innerText:"Undo veto"}});this.vetoButton=a;var b=this;a.addEventListener("click",function(){b.currentGame.unveto();b.hideVetoButton();b.selector.updateHistory()});return a};
GameDisplay$$module$lib$game_display.prototype.displayVetoButton=function(){Helpers$$module$lib$helpers.removeClass(this.vetoButton,this.hiddenClass(!1))};GameDisplay$$module$lib$game_display.prototype.hideVetoButton=function(){Helpers$$module$lib$helpers.addClass(this.vetoButton,this.hiddenClass(!1))};GameDisplay$$module$lib$game_display.prototype.updateVetoDisplay=function(a){("kingdom"===a?this.kingdomArea:this.eventsAndLandmarksArea).appendChild(this.vetoButton);this.displayVetoButton()};
var module$lib$game_display={};module$lib$game_display.GameDisplay=GameDisplay$$module$lib$game_display;var GameHistory$$module$lib$game_history=function(a){this.kingdomCards=GameHistory$$module$lib$game_history.convertCards(a.kingdomCards);this.eventsAndLandmarks=GameHistory$$module$lib$game_history.convertCards(a.eventsAndLandmarks);this.vetoed=GameHistory$$module$lib$game_history.convertCards(a.vetoed);this.currentCards=GameHistory$$module$lib$game_history.convertCards(a.currentCards);this.bane=a.bane?a.bane.name:!1;this.maxCards=a.maxCards;this.platCol=a.platCol;this.shelters=a.shelters;this.maxBySet=
a.maxBySet;this.minBySet=a.minBySet;this.id=a.id};GameHistory$$module$lib$game_history.convertCards=function(a){var b=[];a.forEach(function(a){b.push(a.name)});return b};var NavigationDisplay$$module$lib$game_history=function(a){this.el=a.el;this.selector=a.selector};
NavigationDisplay$$module$lib$game_history.prototype.initializeDisplay=function(){this.forwardButton=Helpers$$module$lib$helpers.createDOMElement({type:"button",attributes:{innerText:"next set",hidden:!0,disabled:!0},nonStandardAttributes:{onClick:"window.history.forward()"}});this.backButton=Helpers$$module$lib$helpers.createDOMElement({type:"button",attributes:{innerText:"previous set",hidden:!0,disabled:!0},nonStandardAttributes:{onClick:"window.history.back()"}});this.navigationMessage=Helpers$$module$lib$helpers.createDOMElement({type:"div",
attributes:{hidden:!0,innerText:"You can also navigate between sets using the browser history."}});this.el.appendChild(this.backButton);this.el.appendChild(this.forwardButton);this.el.appendChild(this.navigationMessage)};
NavigationDisplay$$module$lib$game_history.prototype.updateNavigationDisplay=function(){this.selector.canGoBack()||this.selector.canGoForward()?this.navigationMessage.removeAttribute("hidden"):this.navigationMessage.setAttribute("hidden",!0);this.selector.canGoBack()?(this.backButton.removeAttribute("hidden"),this.backButton.removeAttribute("disabled")):this.backButton.setAttribute("disabled",!0);this.selector.canGoForward()?(this.forwardButton.removeAttribute("hidden"),this.forwardButton.removeAttribute("disabled")):
this.forwardButton.setAttribute("disabled",!0)};var module$lib$game_history={};module$lib$game_history.GameHistory=GameHistory$$module$lib$game_history;module$lib$game_history.NavigationDisplay=NavigationDisplay$$module$lib$game_history;var SortDisplay$$module$lib$sort_display=function(a){this.cardSelector=a;this.el=document.getElementById("dominionator-sort-form");this.properties=[["name","Card Name"],["set","Set Name"],["cost","Cost"]];this.currentProperties=["name","set","cost"];this.setListeners();this.sortOrder=[]};SortDisplay$$module$lib$sort_display.prototype.render=function(){var a=this.createUl();this.constructListItems(a)};
SortDisplay$$module$lib$sort_display.prototype.createUl=function(){var a=Helpers$$module$lib$helpers.createDOMElement({type:"ul",attributes:{id:"dominionator-sort-boxes"}});this.el.appendChild(a);return a};SortDisplay$$module$lib$sort_display.prototype.constructListItems=function(a){for(var b,c,d=0;3>d;d++)b=SortDisplay$$module$lib$sort_display.createLi(d),c=this.createSelectBox(d),b.appendChild(c),a.appendChild(b)};
SortDisplay$$module$lib$sort_display.createLi=function(a){var b=document.createElement("li");a=Helpers$$module$lib$helpers.createDOMElement({type:"div",attributes:{innerText:a?"then by":"Sort by:"}});b.appendChild(a);return b};
SortDisplay$$module$lib$sort_display.prototype.createSelectBox=function(a){for(var b,c=Helpers$$module$lib$helpers.createDOMElement({type:"select",attributes:{id:"dominionator-sort-"+a}}),d=0;d<this.properties.length;d++)b=Helpers$$module$lib$helpers.createDOMElement({type:"option",attributes:{value:this.properties[d][0],innerText:this.properties[d][1]}}),a===d&&b.setAttribute("selected",!0),c.appendChild(b);return c};
SortDisplay$$module$lib$sort_display.prototype.setListeners=function(){this.el.addEventListener("change",this.updateSort())};SortDisplay$$module$lib$sort_display.prototype.updateSort=function(){var a=this;return function(b){var c=Helpers$$module$lib$helpers.optionsFormToArray(b.target.form),d=Array.prototype.indexOf.call(a.el.elements,b.target);b=Helpers$$module$lib$helpers.otherIndexOfValue(a.el.elements,b.target.value,d);a.swapDisplayedProperties(d,b);a.cardSelector.updateSort(c)}};
SortDisplay$$module$lib$sort_display.prototype.swapDisplayedProperties=function(a,b){var c=this.el.elements,d=this.currentProperties[a];c[b].value=d;this.currentProperties[b]=d;this.currentProperties[a]=c[a].value};SortDisplay$$module$lib$sort_display.prototype.pullSortOrder=function(){return this.currentProperties};var module$lib$sort_display={};module$lib$sort_display.SortDisplay=SortDisplay$$module$lib$sort_display;var CardSelector$$module$lib$card_selector=function(){this.cardList=new CardList$$module$lib$card_list;this.currentGameId=this.lastGameId=-1};
CardSelector$$module$lib$card_selector.prototype.createNewGame=function(a){this.currentGameId=this.lastGameId+=1;a=a||{};this.currentGame=new Game$$module$lib$game(this.cardList,a.alchemy_min_3,this.gameDisplay,this.lastGameId);a.newGame=!0;this.currentGame.selectCards(a);this.updateCardDisplay(a);history.pushState(new GameHistory$$module$lib$game_history(this.currentGame),"Dominionator!")};
CardSelector$$module$lib$card_selector.prototype.displayCards=function(){var a=this.sortDisplay.pullSortOrder();this.cardList.sortKingdomCards(a);this.displayAllCards()};CardSelector$$module$lib$card_selector.prototype.start=function(){window.onpopstate=this.updateGame();this.cardList.initializeCards(this.initializeDocument())};
CardSelector$$module$lib$card_selector.prototype.initializeDocument=function(){var a=this;return function(){a.initializeForm(a.setVetoListener());a.currentGame=new NullGame$$module$lib$game(a.cardList);a.gameDisplay=new GameDisplay$$module$lib$game_display({selector:a,el:document.getElementById("dominionator-card-location")});a.gameDisplay.createCardDisplays(a.displayCards.bind(a));a.initializeNavigation()}};
CardSelector$$module$lib$card_selector.prototype.initializeNavigation=function(){this.navigationDisplay=new NavigationDisplay$$module$lib$game_history({el:document.getElementById("dominionator-navigation"),selector:this});this.navigationDisplay.initializeDisplay()};
CardSelector$$module$lib$card_selector.prototype.updateGame=function(){var a=this;return function(b){a.currentGame=Game$$module$lib$game.convertFromHistory({gameState:b.state,cardList:a.cardList,gameDisplay:a.gameDisplay});a.currentGameId=a.currentGame.id;a.updateCardDisplay();a.gameDisplay.hideVetoButton()}};
CardSelector$$module$lib$card_selector.prototype.setVetoListener=function(){var a=document.getElementById("dominionator-card-location"),b=this;return function(){a.addEventListener("click",function(a){a=a.target;"BUTTON"===a.tagName&&a.classList.contains("veto-button")&&b.vetoCard(a.cardDisplay)})}};
CardSelector$$module$lib$card_selector.prototype.initializeForm=function(a){this.selectForm=new NewGameForm$$module$lib$card_select_form({selector:this,el:document.getElementById("dominionator-input-form")});this.selectForm.initializeForm();this.sortDisplay=new SortDisplay$$module$lib$sort_display(this);this.sortDisplay.render();a()};CardSelector$$module$lib$card_selector.prototype.displayAllCards=function(){this.gameDisplay.displayAllCards()};
CardSelector$$module$lib$card_selector.prototype.constructCardName=function(a){return this.gameDisplay.constructCardName(a)};CardSelector$$module$lib$card_selector.prototype.vetoCard=function(a){this.currentGame.veto(a.card);this.gameDisplay.displayVetoButton();this.updateHistory()};CardSelector$$module$lib$card_selector.prototype.updateHistory=function(){history.replaceState(new GameHistory$$module$lib$game_history(this.currentGame),"Dominionator!")};
CardSelector$$module$lib$card_selector.prototype.updateCardDisplay=function(a){this.gameDisplay.currentGame=this.currentGame;this.gameDisplay.updateCardDisplay(a);this.navigationDisplay.updateNavigationDisplay()};CardSelector$$module$lib$card_selector.prototype.updateSort=function(a){this.currentGame&&this.displayCards({properties:a})};CardSelector$$module$lib$card_selector.prototype.canGoForward=function(){return this.currentGameId<this.lastGameId};
CardSelector$$module$lib$card_selector.prototype.canGoBack=function(){return 1<=this.currentGameId};window.CardSelector=CardSelector$$module$lib$card_selector;var module$lib$card_selector={};module$lib$card_selector.CardSelector=CardSelector$$module$lib$card_selector; //# sourceMappingURL=compiled.js.map
